# HSEBank

## Общая идея решения

Разработана система учета финансов с акцентом на модуль финансового учета. Реализованы основные сущности: банковские счета, категории операций и финансовые операции. Система предоставляет инструменты для управления личными финансами, анализа трат и планирования бюджета.

### Основной функционал
- Создание, редактирование и удаление счетов
- Создание, редактирование и удаление категорий доходов/расходов  
- Создание, редактирование и удаление финансовых операций
- Автоматический пересчет баланса счетов при операциях
- Аналитика: разница доходов/расходов, группировка по категориям
- Типобезопасность через специализированные value objects
- Расширяемая архитектура с поддержкой DI

### Изменения в функциональных требованиях
- Добавлена строгая типобезопасность через record types и value objects
- Реализована система уведомлений о событиях (наблюдатель)
- Добавлена поддержка команд с отменой операций
- Внедрено автоматическое обновление балансов через наблюдателей

## Принципы SOLID и GRASP

### SOLID принципы

#### 1. SRP
- `BankAccountFacade` - отвечает только за операции со счетами
- `CategoryFacade` - отвечает только за работу с категориями
- `OperationFacade` - отвечает только за управление операциями
- `AnalyticsFacade` - отвечает только за аналитику

#### 2. OCP
- `BaseRepository<TEntity, TId>` - открыт для расширения, закрыт для изменений
- `ICommand` и декораторы - легко добавляются новые команды и функциональность
- Все интерфейсы позволяют добавлять новые реализации без изменения существующего кода

#### 3. LSP
- Все реализации интерфейсов (`BankAccountRepository`, `CategoryRepository`) взаимозаменяемы
- Record types (`AccountId`, `CategoryId`) могут использоваться везде, где ожидается `EntityId<int>`

#### 4. ISP
- Разделенные интерфейсы: `IBankAccountFacade`, `ICategoryFacade`, `IOperationFacade`
- Узкоспециализированные контракты вместо одного общего интерфейса

#### 5. DIP
- Все зависимости внедряются через конструкторы
- Высокоуровневые модули зависят от абстракций (`IRepository`, `IFacade`), а не от деталей

### GRASP принципы

#### 1. High Cohesion
- `ValueObjects` - сгруппирована логика типобезопасных значений
- `Entities` - сгруппированы доменные сущности
- `Factories` - сгруппирована логика создания объектов
- `Facades` - сгруппирована бизнес-логика по доменным областям

#### 2. Low Coupling
- Компоненты связаны только через интерфейсы
- DI-контейнер управляет зависимостями
- Отсутствуют прямые зависимости между конкретными реализациями

#### 3. Creator
- Фабрики (`BankAccountFactory`, `CategoryFactory`) создают соответствующие объекты
- `BaseFactory` содержит общую логику генерации ID

#### 4. Controller
- Фасады выступают в роли контроллеров для соответствующих доменных областей
- `Program` координирует работу всей системы

#### 5. Pure Fabrication
- `BaseRepository` - искусственный класс для устранения дублирования кода
- `OperationNotifier` - служебный класс для управления наблюдателями

## Паттерны GoF

### 1. Фабрика (Factory) 
**Реализация:** `BaseFactory<TId>`, `BankAccountFactory`, `CategoryFactory`, `OperationFactory`  
**Важность:** Централизация создания объектов, гарантия валидного состояния, инкапсуляция логики генерации ID  
**Классы:** `Implementations/Factories/`

### 2. Фасад (Facade)
**Реализация:** `BankAccountFacade`, `CategoryFacade`, `OperationFacade`, `AnalyticsFacade`  
**Важность:** Упрощение сложных подсистем, предоставление единого интерфейса для групп операций  
**Классы:** `Implementations/Facades/`

### 3. Репозиторий (Repository)
**Реализация:** `BaseRepository<TEntity, TId>`, `BankAccountRepository`, `CategoryRepository`, `OperationRepository`  
**Важность:** Абстракция доступа к данным, отделение бизнес-логики от механизмов хранения  
**Классы:** `Implementations/Repositories/`

### 4. Команда (Command)
**Реализация:** `ICommand`, `CreateAccountCommand`, `CreateOperationCommand`  
**Важность:** Инкапсуляция запросов как объектов, поддержка отмены операций, очередь команд  
**Классы:** `Implementations/Commands/`

### 5. Декоратор (Decorator)
**Реализация:** `TimingCommandDecorator`, `LoggingCommandDecorator`  
**Важность:** Динамическое добавление функциональности без изменения основного кода  
**Классы:** `Implementations/Decorators/`

### 6. Наблюдатель (Observer)
**Реализация:** `IOperationObserver`, `BalanceUpdateObserver`, `OperationNotifier`  
**Важность:** Уведомление заинтересованных объектов о событиях, слабая связанность  
**Классы:** `Implementations/Observers/`

### 7. Шаблонный метод (Template Method)
**Реализация:** `BaseFactory<TId>`, `BaseRepository<TEntity, TId>`  
**Важность:** Определение скелета алгоритма с изменяемыми шагами в производных классах  
**Классы:** `Implementations/Factories/BaseFactory.cs`, `Implementations/Repositories/BaseRepository.cs`

### 8. Стратегия (Strategy)
**Реализация:** Все интерфейсы системы (`IRepository`, `IFacade`, `IFactory`)  
**Важность:** Инкапсуляция группы алгоритмов, возможность взаимозаменяемости реализаций  
**Классы:** `Contracts/`

### 9. Value Object (из DDD)
**Реализация:** `AccountId`, `CategoryId`, `OperationId`, `Money`, `PositiveDecimal`  
**Важность:** Типобезопасность, неизменяемость, собственные бизнес-правила  
**Классы:** `ValueObjects/`

## Дополнительные архитектурные паттерны

### 10. Dependency Injection
**Реализация:** Microsoft.Extensions.DependencyInjection в Program.cs  
**Важность:** Управление зависимостями, снижение связанности, улучшение тестируемости

### 11. Interface Segregation
**Реализация:** Разделенные интерфейсы в Contracts/  
**Важность:** Узкая специализация, предотвращение "жирных" интерфейсов

## Инструкция по запуску
   ```bash
   dotnet run --project ./HSEBank/HSEBank.csproj
